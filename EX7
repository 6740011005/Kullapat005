async function fetchAndDisplayUsers() {
    const statusMessage = document.getElementById('status-message');
    const container = document.getElementById('user-list-container');
    const apiUrl = 'https://jsonplaceholder.typicode.com/users';

    try {
        // 1. ดึงข้อมูลจาก API
        const response = await fetch(apiUrl);

        // ตรวจสอบว่า Response สำเร็จหรือไม่ (เช่น status 200-299)
        if (!response.ok) {
            throw new Error('โครงข่ายมีปัญหาหรือไม่สามารถติดต่อ Server ได้');
        }

        const users = await response.json();

        // 2. ล้างข้อความกำลังโหลด
        statusMessage.textContent = '';

        // 3. วนลูปสร้าง Element สำหรับผู้ใช้แต่ละคน
        users.forEach(user => {
            const userCard = document.createElement('article');
            userCard.className = 'user-card';

            // สร้างเนื้อหาภายในแบบปลอดภัยด้วย textContent
            const nameHeader = document.createElement('h3');
            nameHeader.textContent = user.name;

            const usernamePara = document.createElement('p');
            usernamePara.textContent = `Username: ${user.username}`;

            const emailPara = document.createElement('p');
            emailPara.textContent = `Email: ${user.email}`;

            // ประกอบการ์ด
            userCard.appendChild(nameHeader);
            userCard.appendChild(usernamePara);
            userCard.appendChild(emailPara);

            // นำไปแสดงบนหน้าเว็บ
            container.appendChild(userCard);
        });

    } catch (error) {
        // 4. จัดการกรณีเกิดข้อผิดพลาด
        console.error('Fetch error:', error);
        statusMessage.textContent = 'ไม่สามารถโหลดข้อมูลผู้ใช้ได้ กรุณาลองใหม่ในภายหลัง';
        statusMessage.className = 'error-text';
    }
}

// เรียกใช้งานฟังก์ชันเมื่อโหลดหน้าเว็บ
fetchAndDisplayUsers();

